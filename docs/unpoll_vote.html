<!DOCTYPE html>
<html>
<head>
  <title>Poll Result</title>
  <style>
    .bar {
      height: 20px;
      background: url('img/andapoll.gif');
      display: inline-block;
      vertical-align: middle;
    }
  </style>
</head>
<body>
  <h2>Vote:</h2>
  <button onclick="vote(0)">Yes</button>
  <button onclick="vote(1)">Yes but cooler</button>
  <h2>Result:</h2>
  <table>
    <tr>
      <td>Yes:</td>
      <td>
        <div id="bar-yes" class="bar"></div>
        <span id="percent-yes">0%</span>
      </td>
    </tr>
    <tr>
      <td>Yes but cooler:</td>
      <td>
        <div id="bar-no" class="bar"></div>
        <span id="percent-no">0%</span>
      </td>
    </tr>
  </table>
  <script>
    // Helper to get or initialize votes from localStorage
    function getVotes() {
      let votes = localStorage.getItem('poll_result');
      if (!votes) {
        // Default: 0||0
        localStorage.setItem('poll_result', '0||0');
        return [0, 0];
      }
      return votes.split('||').map(Number);
    }

    // Helper to save votes
    function setVotes(yes, no) {
      localStorage.setItem('poll_result', yes + '||' + no);
    }

    // Update UI
    function updateResult() {
      const [yes, no] = getVotes();
      const total = yes + no;
      const yesPercent = total === 0 ? 0 : Math.round((yes / total) * 100);
      const noPercent = total === 0 ? 0 : Math.round((no / total) * 100);

      document.getElementById('bar-yes').style.width = (yesPercent) + 'px';
      document.getElementById('percent-yes').textContent = yesPercent + '%';
      document.getElementById('bar-no').style.width = (noPercent) + 'px';
      document.getElementById('percent-no').textContent = noPercent + '%';
    }

    // Voting function
    function vote(option) {
      let [yes, no] = getVotes();
      if (option === 0) yes++;
      else if (option === 1) no++;
      setVotes(yes, no);
      updateResult();
    }

    // Initial display
    updateResult();
  </script>
</body>
</html>